@model eCommerceProject.Models.ApplicationUser

@{
	ViewBag.Title = "UpdateImage";
	if (User.IsInRole("Admin"))
	{
		Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
	}
	if (User.IsInRole("Seller"))
	{
		Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
	}
	if (User.IsInRole("Customer"))
	{
		Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
	}

}

<h2>Update Image</h2>


@using (Html.BeginForm("EditProfile", "Manage", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
	@Html.AntiForgeryToken()

<div class="form-horizontal">
	<h4>ApplicationUser</h4>
	<hr />
	@Html.ValidationSummary(true, "", new { @class = "text-danger" })
	@Html.HiddenFor(model => model.Id)


	<div class="form-group">
		@Html.LabelFor(model => model.FullName, htmlAttributes: new { @class = "control-label col-md-2" })
		<div class="col-md-10">
			@Html.EditorFor(model => model.FullName, new { htmlAttributes = new { @class = "form-control" } })
			@Html.ValidationMessageFor(model => model.FullName, "", new { @class = "text-danger" })
		</div>
	</div>
	<div class="form-group">
		@Html.LabelFor(model => model.Address, htmlAttributes: new { @class = "control-label col-md-2" })
		<div class="col-md-10">
			@Html.EditorFor(model => model.Address, new { htmlAttributes = new { @class = "form-control" } })
			@Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
		</div>
	</div>
	<div class="form-group">
		@Html.LabelFor(model => model.PhoneNumber, htmlAttributes: new { @class = "control-label col-md-2" })
		<div class="col-md-10">
			@Html.EditorFor(model => model.PhoneNumber, new { htmlAttributes = new { @class = "form-control" } })
			@Html.ValidationMessageFor(model => model.PhoneNumber, "", new { @class = "text-danger" })
		</div>
	</div>
	<div class="form-group">
		@Html.LabelFor(model => model.Email, htmlAttributes: new { @class = "control-label col-md-2" })
		<div class="col-md-10">
			@Html.DisplayFor(model => model.Email, new { htmlAttributes = new { @class = "form-control" } })
			@Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
		</div>
	</div>
	<div class="col">
		<div class="btn btn-primary">
			@Html.LabelFor(m => m.ImagePath, new { @class = "control-label col-md" })
			@Html.TextBoxFor(m => m.ImageFile, new { type = "file", id = "imageBrowes" })
			@Html.ValidationMessageFor(model => model.ImagePath, "*required", new { @class = "text-danger" })

		</div>
		<hr />


		<div id="imgPreview" class="col-md-12" style="display:none">
			<img class="img-responsive col-md-12" id="targetImg" />
			<div class="caption">
				<a href="#" onclick="ClearPreview()"><i class="fas fa-trash"></i></a>
				<span id="description"></span>
			</div>
		</div>

	</div>



	<div class="form-group">
		<div class="col-md-offset-2 col-md-10">
			<input type="submit" value="Save" class="btn btn-success btn-tone" />
		</div>
	</div>
</div>
}

<div>
	@Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
	@Scripts.Render("~/bundles/jqueryval")
	<script src="~/Scripts/jquery-3.2.1.min.js"></script>
	<script>

		$(document).ready(function () {

			$("#imageBrowes").change(function () {

				var File = this.files;

				if (File && File[0]) {
					ReadImage(File[0]);
				}

			})


		})


		var ReadImage = function (file) {

			var reader = new FileReader;
			var image = new Image;

			reader.readAsDataURL(file);
			reader.onload = function (_file) {

				image.src = _file.target.result;
				image.onload = function () {

					var height = this.height;
					var width = this.width;
					var type = file.type;
					var size = ~~(file.size / 1024) + "KB";

					$("#targetImg").attr('src', _file.target.result);
					$("#description").text("Size:" + size + ", " + height + "X " + width + ", " + type + "");
					$("#imgPreview").show();

				}

			}

		}

		var ClearPreview = function () {
			$("#imageBrowes").val('');
			$("#description").text('');
			$("#imgPreview").hide();

		}


	</script>
}
