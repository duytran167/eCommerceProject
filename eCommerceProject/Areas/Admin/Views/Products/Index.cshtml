@model IEnumerable<eCommerceProject.Models.Product>

@{
	ViewBag.Title = "Index";
	Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<h2>Index</h2>

<div class="row m-b-30">
	<div class="col-lg-8">
		<form>
			@using (Html.BeginForm("Index", "Products", "POST"))
			{
				<div class="d-md-flex ">
					<div class="m-b-10 col-md-3 form-row ">

						@Html.DropDownList("filter", (IEnumerable<SelectListItem>)ViewBag.DanhMuc, "Select Category", new { @class = "form-control col-md-12 " })




					</div>
					<div class="input-affix m-b-10 ">

						<i class="prefix-icon anticon anticon-search"></i>
						@Html.TextBox("search", null, new { @type = "text", @class = "form-control col-md-10", @placeholder = "Search..." })


					</div>
					<input style="height: 45px" value="Filter" type="submit" class="btn btn-info btn-tone m-r-5" />

				</div>
			}
		</form>

	</div>
	<div class="col-lg-4 text-right">
		<button class="btn btn-primary btn-tone">
			<i class="anticon anticon-plus-circle m-r-5"></i>
			<span>@Html.ActionLink("Add Product", "Create")</span>
		</button>
	</div>
</div>
<div class="m-t-25">
	<table class="table">
		<tr>
			<th><a href="javascript:;">Id</a></th>
			<th><a href="javascript:;">ProductName</a></th>
			<th>Category</th>
			<th>Price</th>
			<th>
				Best Seller
			</th>
			<th>
				Public
			</th>
			<th>
				Created Date
			</th>
			<th></th>
		</tr>

		@foreach (var item in Model)
		{
			<tr>
				<td>
					@Html.DisplayFor(modelItem => item.Id)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.ProductName)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Categories.CategoryName)
				</td>
				<td>
					@item.Price.ToString("#,##0") VND
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.BestSellers)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Active)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Discount)
				</td>

				<td>
					@item.CreatedDate.ToString("dd MMM yyyy")
				</td>

				<td>
					@Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
					@Html.ActionLink("Details", "Details", new { id = item.Id }) |
					@Html.ActionLink("Delete", "Delete", new { id = item.Id })
				</td>
			</tr>
		}

	</table>
</div>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="~/Scripts/ASPSnippets_Pager.min.js"></script>
<script type="text/javascript">
				var sortName = "";
				var sortDirection = "ASC";
$(function () {
GetCustomers(1);
});
$("body").on("click", "#tblCustomers th a", function () {
sortName = $(this).html();
sortDirection = sortDirection == "ASC" ? "DESC" : "ASC";
GetCustomers(1);
});
$("body").on("click", ".Pager .page", function () {
GetCustomers(parseInt($(this).attr('page')));
});
				function GetCustomers(pageIndex) {
$.ajax({
type: "POST",
url: "/Products/Index",
data: '{pageIndex: ' + pageIndex + ', sortName: "' + sortName + '", sortDirection: "' + sortDirection + '"}',
contentType: "application/json; charset=utf-8",
dataType: "json",
success: OnSuccess,
failure: function (response) {
alert(response.d);
},
error: function (response) {
alert(response.d);
								}
});
};
				function OnSuccess(response) {
						var model = response;
						var row = $("#tblCustomers tr:last-child").removeAttr("style").clone(true);
$("#tblCustomers tr").not($("#tblCustomers tr:first-child")).remove();
$.each(model.Customers, function () {
								var customer = this;
$("td", row).eq(0).html(customer.I);
$("td", row).eq(1).html(customer.ProductName);
$("td", row).eq(2).html(customer.City);
$("td", row).eq(3).html(customer.Country);
$("#tblCustomers").append(row);
row = $("#tblCustomers tr:last-child").clone(true);
});
$(".Pager").ASPSnippets_Pager({
ActiveCssClass: "current",
PagerCssClass: "pager",
PageIndex: model.PageIndex,
PageSize: model.PageSize,
RecordCount: model.RecordCount
});
};
</script>